<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>AV30 - Avaliação Integrada</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>


<style>
body{
  background: linear-gradient(135deg,#1e3a8a,#2563eb);
  min-height:100vh;
  font-family: Arial, Helvetica, sans-serif;
}

.card-av{
  max-width:800px;
  margin:auto;
  margin-top:30px;
  border-radius:15px;
  background:white;
}

.progress{
  height:20px;
}

.progress-bar{
  background-color:#0d6efd;
  transition: width 0.4s ease;
}

textarea{
  resize:none;
}

label{
  font-weight:500;
}

.card{
  border-radius:12px;
}

.card-body{
  padding:20px;
}

.btn-outline-primary{
  font-weight:500;
}

textarea:focus,
select:focus,
input:focus{
  box-shadow:0 0 0 0.2rem rgba(13,110,253,.25);
  border-color:#0d6efd;
}

.hidden{
  display:none;
}
</style>
</head>

<body>

<div class="container">
<div class="card card-av shadow p-4">

<h4 class="text-center text-primary mb-3">AV30 – Avaliação Integrada</h4>

<div class="progress mb-3">
  <div id="progressBar" class="progress-bar" style="width:0%"></div>
</div>

<div id="conteudo"></div>

<div class="text-center mt-3">
<button id="btnProximo" class="btn btn-primary">Próximo</button>
</div>

</div>
</div>

<script>
const { jsPDF } = window.jspdf;

let etapa = 0;
let respostas = {};
let pontuacao = 0;

const etapas = [

/* TELA INICIAL */
{
html: `
<label>Nome completo:</label>
<input type="text" id="nome" class="form-control mb-3">
<p class="text-muted">A avaliação possui 3 partes. Leia com atenção.</p>
`
},

/* PARTE 1 */
{
html: `
<h5>Parte 1 – Produção de Tipos Textuais (12 pts)</h5>

<p><b>Situação:</b><br>
Durante o período da manhã, o sistema da empresa apresentou instabilidade, 
o que dificultou a liberação de pedidos. Como consequência, algumas entregas 
foram realizadas com atraso e clientes entraram em contato solicitando explicações.</p>

<hr>

<label><b>1. Relatório simples:</b></label>
<p class="text-muted">Registre de forma objetiva o ocorrido, informando a situação, o motivo e as providências adotadas.</p>
<textarea id="relatorio" class="form-control mb-4" rows="4"
placeholder="Elabore aqui o relatório simples..."></textarea>

<label><b>2. Ata:</b></label>
<p class="text-muted">Redija uma ata da reunião realizada para analisar o problema e definir soluções.</p>
<textarea id="ata" class="form-control mb-4" rows="4"
placeholder="Redija aqui a ata da reunião..."></textarea>

<label><b>3. Carta ou E-mail profissional:</b></label>
<p class="text-muted">Produza uma comunicação formal destinada ao cliente explicando a situação e informando as providências.</p>
<textarea id="carta" class="form-control mb-3" rows="4"
placeholder="Escreva aqui a carta ou e-mail profissional..."></textarea>
`
},

/* PARTE 2 */
{
html: `
<h5>Parte 2 – Tipos de Informação (8 pts)</h5>

<div class="row g-3">

${criarCard(1,"Ouvi dizer que o estoque vai fechar amanhã.")}
${criarCard(2,"O relatório informa falta de produtos no estoque.")}
${criarCard(3,"Segundo a apostila do curso, o controle de estoque é essencial.")}
${criarCard(4,"Eu acho que o sistema está muito lento.")}

</div>
`
},

/* PARTE 3 */
/* PARTE 3 */
{
html: `
<h5>Parte 3 – Texto Argumentativo (9 pts)</h5>

<p><b>Tema 1:</b><br>
Um funcionário recebeu uma informação sobre atraso na entrega por meio de um comentário em rede social. 
Sem confirmar a veracidade, ele repassou a informação ao cliente, causando preocupação desnecessária.<br>
Explique por que é importante verificar a fonte antes de repassar uma informação no ambiente de trabalho 
e quais podem ser as consequências de não fazer essa verificação.</p>

<textarea id="arg1" class="form-control mb-4" rows="4" 
placeholder="Desenvolva seu texto argumentativo aqui..."></textarea>

<p><b>Tema 2:</b><br>
Um colaborador informou apenas “Entrega cedo” em uma mensagem enviada ao motorista. 
O motorista interpretou como 10h da manhã, mas o cliente esperava a entrega às 8h.<br>
Argumente sobre a importância da clareza na comunicação profissional e explique 
como mensagens mal formuladas podem impactar o trabalho.</p>

<textarea id="arg2" class="form-control mb-4" rows="4"
placeholder="Desenvolva seu texto argumentativo aqui..."></textarea>

<p><b>Tema 3:</b><br>
Durante a elaboração de um trabalho, um aluno copiou informações de um site e entregou como se fossem de sua autoria, sem citar a fonte.<br>
Explique por que essa atitude não é correta e argumente sobre a importância da ética na pesquisa e na produção de textos.</p>

<textarea id="arg3" class="form-control mb-3" rows="4"
placeholder="Desenvolva seu texto argumentativo aqui..."></textarea>
`
}

];

function criarCard(id,texto){
return `
<div class="col-12">
  <div class="card shadow-sm">
    <div class="card-body">

      <button class="btn btn-outline-primary w-100 mb-2" 
        data-bs-toggle="collapse" 
        data-bs-target="#card${id}">
        Ver situação
      </button>

      <div class="collapse" id="card${id}">
        <hr>
        <p>${texto}</p>

        <label class="form-label">Tipo de informação:</label>
        <select class="form-select mb-2" id="tipo${id}">
          <option value="">Selecione</option>
          <option value="pessoal">Informação pessoal</option>
          <option value="profissional">Informação profissional</option>
          <option value="academica">Informação acadêmica ou técnica</option>
          <option value="informal">Informação informal</option>
        </select>

        <label class="form-label">Complete o exemplo:</label>
        <textarea class="form-control" rows="2" id="comp${id}"></textarea>
      </div>

    </div>
  </div>
</div>
`;
}


function atualizarBarra(){
let progresso = (etapa/(etapas.length-1))*100;
document.getElementById("progressBar").style.width = progresso+"%";
}

function carregar(){
document.getElementById("conteudo").innerHTML = etapas[etapa].html;
atualizarBarra();
}

document.getElementById("btnProximo").addEventListener("click",()=>{

if(etapa===0){
let nome = document.getElementById("nome").value.trim();
if(nome===""){alert("Informe seu nome."); return;}
respostas.nome = nome;
}

if(etapa===1){
respostas.relatorio = relatorio.value;
respostas.ata = ata.value;
respostas.carta = carta.value;
}

if(etapa===2){
for(let i=1;i<=4;i++){
let tipo = document.getElementById("tipo"+i).value;
let comp = document.getElementById("comp"+i).value;
if(tipo===""){alert("Responda todos os cards."); return;}
respostas["tipo"+i]=tipo;
respostas["comp"+i]=comp;

if(tipo==="informal" && i===1) pontuacao+=1;
if(tipo==="profissional" && i===2) pontuacao+=1;
if(tipo==="academica" && i===3) pontuacao+=1;
if(tipo==="pessoal" && i===4) pontuacao+=1;

if(comp.length>5) pontuacao+=1;
}
}

if(etapa===3){
respostas.arg1=arg1.value;
respostas.arg2=arg2.value;
respostas.arg3=arg3.value;
pontuacao+=9;
gerarPDF();
return;
}

etapa++;
carregar();

});

function gerarPDF(){

const doc = new jsPDF();
let y = 10;

doc.text("AV30 - Avaliação Integrada",10,y); y+=10;
doc.text("Nome: "+respostas.nome,10,y); y+=10;

doc.text("Parte 1:",10,y); y+=10;
doc.text(respostas.relatorio.substring(0,90),10,y); y+=10;
doc.text(respostas.ata.substring(0,90),10,y); y+=10;
doc.text(respostas.carta.substring(0,90),10,y); y+=10;

doc.text("Parte 2:",10,y); y+=10;
for(let i=1;i<=4;i++){
doc.text("Card "+i+": "+respostas["tipo"+i],10,y); y+=8;
}

doc.text("Parte 3:",10,y); y+=10;
doc.text(respostas.arg1.substring(0,90),10,y); y+=10;
doc.text(respostas.arg2.substring(0,90),10,y); y+=10;
doc.text(respostas.arg3.substring(0,90),10,y); y+=10;

doc.text("Pontuação Parcial Objetiva: "+pontuacao+" / 30",10,y);

doc.save("AV30_"+respostas.nome+".pdf");

document.getElementById("conteudo").innerHTML =
"<h4 class='text-success text-center'>PDF gerado com sucesso!</h4>"+
"<p class='text-center'>Envie o arquivo ao professor.</p>";

document.getElementById("btnProximo").classList.add("hidden");
document.getElementById("progressBar").style.width="100%";
}

carregar();

</script>

</body>
</html>
